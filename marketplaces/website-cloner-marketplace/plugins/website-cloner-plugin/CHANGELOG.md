# Website Cloner 插件更新日志

## v2.0.0 (2026-01-28) - 重大更新

### 🎯 核心改进

基于 Bilibili 网站克隆的实战经验，全面升级克隆技术栈。

### ✨ 新增功能

1. **Puppeteer 无头浏览器支持**
   - 完整渲染动态网站内容
   - 支持 SPA（单页应用）如 React、Vue、Angular
   - 执行 JavaScript 获取真实内容

2. **自动滚动加载**
   - 智能触发懒加载图片
   - 自动滚动到页面底部
   - 等待内容完全加载

3. **HTML 格式化**
   - 自动格式化压缩的 HTML
   - 添加换行符和缩进
   - IDE 友好，便于查看和编辑

4. **智能资源提取**
   - 支持协议相对路径（//开头）
   - 提取 data-src 懒加载图片
   - 识别 CSS 背景图片
   - 过滤追踪脚本和广告

5. **多版本保存**
   - index.html - 原始静态框架
   - index-rendered.html - 初次渲染
   - index-full.html - 完整格式化版本（推荐）
   - screenshot.png - 页面截图

### 🐛 问题修复

1. **SPA 应用内容为空**
   - 问题：使用 curl 只能获取空框架
   - 解决：使用 Puppeteer 渲染完整内容

2. **懒加载图片未下载**
   - 问题：图片需要滚动才会加载
   - 解决：自动滚动页面触发加载

3. **HTML 无法识别**
   - 问题：单行 HTML，IDE 无法解析
   - 解决：格式化 HTML，添加换行符

4. **协议相对路径错误**
   - 问题：//开头的 URL 无法下载
   - 解决：自动添加 https: 协议

5. **截图失败**
   - 问题：页面太长导致截图失败
   - 解决：只截取可视区域

### 📊 性能优化

- 限制图片下载数量（30-50个主要图片）
- 并行下载资源（使用 xargs -P）
- 智能过滤不必要的资源
- 优化内存使用

### 📝 文档改进

- 详细的克隆流程说明
- 常见问题和解决方案
- 完整的代码示例
- 最佳实践指南

### 🔧 技术栈

- Puppeteer - 无头浏览器
- Node.js - 脚本执行
- curl - 资源下载
- grep/sed - 文本处理

### 📈 实战案例

成功克隆 Bilibili 网站：
- 完整渲染 34MB HTML（275K行）
- 下载 35 个主要图片（11MB）
- 总大小 49MB
- 完美支持动态内容

### ⚠️ 破坏性变更

- 需要安装 Node.js 和 Puppeteer
- 克隆时间增加（但内容更完整）
- 输出文件结构变化

### 🚀 升级指南

```bash
# 1. 确保安装 Node.js
which node

# 2. 安装 Puppeteer（首次使用）
cd /tmp && npm install puppeteer

# 3. 使用新版本克隆
/website-cloner:clone https://example.com
```

---

## v1.0.0 (2026-01-20) - 初始版本

### 功能

- 基础 HTML/CSS/JS 下载
- 静态资源克隆
- 简单的路径替换

### 限制

- 不支持动态网站
- 无法处理懒加载
- SPA 应用内容为空
