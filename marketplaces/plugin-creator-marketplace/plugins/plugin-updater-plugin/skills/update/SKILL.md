---
name: update
description: 自动更新插件配置和内容。核心原则：将经验转化为通用能力和脚本，而不是创建文档。更新时应精简 skills/commands，添加可复用脚本，删除冗余文档。
---

# 插件更新技能

## 核心原则 ⚠️

**重要**：更新插件时遵循以下原则：

1. **能力优先，文档最少**
   - ❌ 不要创建 CHANGELOG.md, EXPERIENCE.md 等文档
   - ✅ 将经验转化为可复用的脚本和自动化能力

2. **精简优先**
   - ✅ 精简 skills/commands 内容，删除冗余步骤
   - ✅ 用脚本调用替代手动步骤
   - ✅ 保持文档简洁实用

3. **脚本化**
   - ✅ 将复杂流程封装为脚本
   - ✅ 添加通用工具到 scripts/ 目录
   - ✅ 让功能自动化而不是文档化

## 执行步骤

### 1. 读取配置
```bash
# 读取插件配置
<plugin-path>/.claude-plugin/plugin.json
<marketplace-path>/.claude-plugin/marketplace.json
```

### 2. 更新版本和描述
- 递增版本号（次要功能 +0.1.0）
- 更新 description 反映新功能
- 同步更新 plugin.json 和 marketplace.json

### 3. 更新 skills/commands
- 精简内容，删除冗余步骤
- 用脚本调用替代手动操作
- 更新 description 反映新能力

### 4. 添加脚本（如需要）
- 将新能力封装为脚本
- 放入 scripts/ 目录
- 集成到主流程

### 5. 清理文档
- 删除不必要的文档文件
- 只保留 README.md
- 更新 README 版本历史（简短）

## 更新报告

```
✅ 插件更新完成

📦 <plugin-name> v<old> → v<new>

🔄 更新内容：
- plugin.json: description, version
- marketplace.json: 同步更新
- skills/commands: 精简 X 行
- scripts: 新增 X 个脚本
- 文档: 删除 X 个冗余文件

💡 核心改进：
<简述核心能力提升>
```

## 示例

**好的更新**：
- 添加 fix-paths.py 脚本自动修正路径
- 精简 SKILL.md 从 228 行到 95 行
- 删除 CHANGELOG.md, EXPERIENCE.md

**不好的更新**：
- 创建大量文档记录经验
- 保留冗长的手动步骤说明
- 不添加自动化脚本

**内容更新**：
- 添加新命令文件到 commands/
- 添加新技能文件到 skills/
- 更新文档文件

**版本管理**：
- 根据变更类型递增版本号
- 主要变更：x.0.0
- 次要变更：0.x.0
- 补丁变更：0.0.x

### 5. 验证更新

- 验证 JSON 格式正确性
- 检查文件结构完整性
- 确保配置一致性

### 6. 报告结果

向用户清晰报告：
- 更新了哪些文件
- 版本如何变更
- 添加了什么功能
- 下一步建议操作

## 示例场景

**场景 1：版本更新**
```
用户：更新 codex-plugin 到版本 1.2.0
技能：读取配置 → 更新版本号 → 同步 marketplace → 报告结果
```

**场景 2：添加命令**
```
用户：给 my-plugin 添加一个 format 命令
技能：创建命令文件 → 更新文档 → 递增版本 → 报告结果
```

**场景 3：修改描述**
```
用户：更新 plugin-creator 的描述
技能：读取配置 → 更新描述 → 同步 marketplace → 报告结果
```

## 注意事项

1. **备份意识**：提醒用户重要更新前备份
2. **版本规范**：遵循语义化版本规范
3. **配置同步**：确保 plugin.json 和 marketplace.json 一致
4. **验证测试**：更新后建议用户测试
5. **文档更新**：同步更新相关文档

## 错误处理

- 插件路径不存在：提示用户检查路径
- JSON 格式错误：提供修复建议
- 权限不足：提示检查文件权限
- 版本冲突：询问用户如何处理
